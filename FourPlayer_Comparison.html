<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>GameEnclave â€” Comparison (4 Players)</title>
<style>
:root {
  --muted-gold: #d4b45f;
  --dark-bg: #0d0d0d;
  --green: #24a148;
  --red: #c23636;
}

body {
  margin: 0;
  font-family: "Poppins", sans-serif;
  background: url("https://tanveerss.github.io/fcmobile/ComparisonImage.jpg") center/cover no-repeat;
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}

/* === Container === */
#capture {
  margin-top: 25px;
  padding: 28px 18px;
  border-radius: 18px;
  /* default background (will be overridden by selector) */
  background: url("https://tanveerss.github.io/fcmobile/ComparisonImage.jpg") center/cover no-repeat;
  background-size: cover;
  background-position: center;
  box-shadow: 0 8px 30px rgba(0,0,0,0.6);
  display: grid;
  gap: 18px 18px;
  justify-items: center;
  max-width: 1200px;
  width: 100%;
  position: relative;
  color: #fff;
}

/* overlay so text is readable on top of vibrant images */
#capture::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 18px;
  background: linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.65));
  pointer-events: none;
}

/* place inner content above overlay */
#capture > * { position: relative; z-index: 1; }

/* === Header === */
.capture-title {
  grid-column: 1 / -1;
  text-align: center;
  font-size: 26px;
  font-weight: 800;
  color: var(--muted-gold);
  text-shadow: 0 0 8px rgba(212,180,95,0.4);
  padding: 12px 0 6px;
  position: relative;
}
.capture-title::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 110px;
  height: 2px;
  border-radius: 1px;
  background: linear-gradient(90deg, transparent, var(--muted-gold), transparent);
}

/* === Watermark === */
.watermark {
  position: absolute;
  right: 20px;
  bottom: 12px;
  font-size: 13px;
  color: var(--muted-gold);
  font-weight: 600;
  opacity: 0.9;
  z-index: 2;
}

/* === Labels === */
.label {
  width: 70px;
  height: 45px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 15px;
  color: rgba(212,180,95,0.95);
  background: rgba(0,0,0,0.45);
  border-radius: 10px;
}

/* === Player Upload === */
.upload-label {
  position: relative;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
}
.upload-label input[type=file] {
  position: absolute;
  inset: 0;
  opacity: 0;
  cursor: pointer;
}
.player-img {
  height: 160px;
  object-fit: contain;
  filter: drop-shadow(0 8px 20px rgba(0,0,0,0.6));
  transition: transform 0.25s ease;
}
.player-img:hover { transform: translateY(-3px); }
.upload-text { font-size: 12px; color: var(--muted-gold); opacity: 0.8; }

/* === Stat Values === */
.val {
  width: 70px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 17px;
  color: #fff;
  background: rgba(0,0,0,0.45);
  border-radius: 10px;
  box-shadow: inset 0 0 6px rgba(0,0,0,0.6);
  transition: all 0.25s ease;
}
.val.high { background: rgba(36,161,72,0.9); color: #fff; }
.val.low  { background: rgba(194,54,54,0.9); color: #fff; }

/* === Separator === */
.sep { grid-column: 1 / -1; height: 1px; background: rgba(255,255,255,0.04); }

/* === Controls === */
.controls {
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: center;
  margin: 18px auto 30px;
}
.btn {
  background: var(--muted-gold);
  color: #000;
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s ease;
}
.btn:hover { box-shadow: 0 0 10px rgba(212,180,95,0.4); }

/* selector styling */
.select { padding: 8px 10px; border-radius: 8px; border: none; font-weight:700; }

/* thumbnails */
.bg-thumb { width: 64px; height: 40px; object-fit: cover; border-radius: 6px; cursor: pointer; box-shadow: 0 6px 18px rgba(0,0,0,0.5); border: 2px solid transparent; }
.bg-thumb.selected { border-color: var(--muted-gold); }

/* === Responsive === */
@media (max-width:900px) { #capture { max-width: 95%; } .player-img { height: 120px; } .val { width: 60px; height: 38px; font-size: 15px; } }
@media (max-width:500px) { .player-img { height: 100px; } }
</style>
</head>
<body>

<div id="capture">
  <div class="capture-title">Comparison</div>
  <div class="watermark">GameEnclave</div>
</div>

<div class="controls">
  <label style="display:flex;align-items:center;gap:8px;">
    <strong style="color:#fff">Background:</strong>
    <select id="bgSelect" class="select">
      <option value="https://tanveerss.github.io/fcmobile/ComparisonImage.jpg">Default</option>
      <option value="https://tanveerss.github.io/fcmobile/ComparisonImage2.jpg">Variant 2</option>
    </select>
  </label>

  <div id="thumbs" style="display:flex;gap:8px;align-items:center;">
    <img src="https://tanveerss.github.io/fcmobile/ComparisonImage.jpg" class="bg-thumb selected" data-src="https://tanveerss.github.io/fcmobile/ComparisonImage.jpg" onclick="selectThumb(this)">
    <img src="https://tanveerss.github.io/fcmobile/ComparisonImage2.jpg" class="bg-thumb" data-src="https://tanveerss.github.io/fcmobile/ComparisonImage2.jpg" onclick="selectThumb(this)">
  </div>

  <input id="customBg" class="select" placeholder="Or paste a public image URL" style="min-width:260px">

  <button class="btn" onclick="applySelectedBackground()">Apply</button>
  <button class="btn" onclick="downloadCard()">Download</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
const STATS = ["PAC","SHO","PAS","DRI","DEF","PHY"]; 
let playerCount = 0;
const MAX_PLAYERS = 4; // updated to support 4 players
const capture = document.getElementById('capture');

function rebuildGrid() {
  const title = capture.querySelector('.capture-title') || document.createElement('div');
  title.className = 'capture-title';
  title.textContent = 'Comparison';
  const watermark = capture.querySelector('.watermark') || document.createElement('div');
  watermark.className = 'watermark';
  watermark.textContent = 'GameEnclave';

  capture.innerHTML = '';
  capture.appendChild(title);

  capture.style.gridTemplateColumns = `80px repeat(${playerCount}, minmax(180px,1fr))`;

  const corner = document.createElement('div');
  capture.appendChild(corner);

  for (let i = 0; i < playerCount; i++) {
    const div = document.createElement('div');
    div.innerHTML = `
      <label class="upload-label">
        <input type="file" accept="image/*" onchange="previewImage(event,'img${i}')">
        <img id="img${i}" class="player-img" src="" alt="Player ${i+1}">
        <span class="upload-text">Upload</span>
      </label>`;
    capture.appendChild(div);
  }

  STATS.forEach(stat => {
    const labelCell = makeCell(stat, 'label');
    capture.appendChild(labelCell);

    for (let i = 0; i < playerCount; i++) {
      const v = document.createElement('div');
      v.className = 'val';
      v.contentEditable = true;
      v.textContent = 100;
      v.addEventListener('input', highlightStats);
      capture.appendChild(v);
    }

    capture.appendChild(makeSep());
  });

  capture.appendChild(watermark);
  highlightStats();
}

function makeCell(text, cls) {
  const d = document.createElement('div');
  d.className = cls;
  d.textContent = text;
  return d;
}
function makeSep() { const s = document.createElement('div'); s.className = 'sep'; return s; }

function addPlayer() { if (playerCount >= MAX_PLAYERS) return alert(`Max ${MAX_PLAYERS} players allowed.`); playerCount++; rebuildGrid(); }

function previewImage(e, id) { const file = e.target.files[0]; if (!file) return; const url = URL.createObjectURL(file); const img = document.getElementById(id); if (img) img.src = url; }

function highlightStats() {
  const vals = Array.from(capture.querySelectorAll('.val'));
  if (vals.length === 0) return;
  const rows = STATS.length;
  for (let r = 0; r < rows; r++) {
    const start = r * playerCount;
    const rowVals = vals.slice(start, start + playerCount);
    const nums = rowVals.map(v => parseInt(v.textContent) || 0);
    const max = Math.max(...nums);
    const min = Math.min(...nums);
    rowVals.forEach((v, i) => {
      v.classList.remove('high', 'low');
      if (nums[i] === max && max !== min) v.classList.add('high');
      if (nums[i] === min && max !== min) v.classList.add('low');
    });
  }
}

async function downloadCard() {
  document.activeElement.blur();
  // useCORS:true helps when images are hosted on same-origin CDNs; allowTaint allows html2canvas to capture images
  const canvas = await html2canvas(capture, { scale: 3, backgroundColor: null, useCORS: true, allowTaint: true });
  const a = document.createElement('a');
  a.download = 'GameEnclave_Comparison_4Players.png';
  a.href = canvas.toDataURL('image/png');
  a.click();
}

// Background selector handlers
function selectThumb(el) {
  document.querySelectorAll('.bg-thumb').forEach(i => i.classList.remove('selected'));
  el.classList.add('selected');
  document.getElementById('bgSelect').value = el.dataset.src;
}
function applySelectedBackground() {
  const sel = document.getElementById('bgSelect').value.trim();
  const custom = document.getElementById('customBg').value.trim();
  const url = custom || sel;
  if (!url) return alert('Please choose or paste a public image URL for the background.');
  // set background on #capture (this will be captured by html2canvas when served from same origin)
  capture.style.backgroundImage = `url("${url}")`;
}

// Init: start with 4 players
addPlayer(); addPlayer(); addPlayer(); addPlayer();
</script>
</body>
</html>
